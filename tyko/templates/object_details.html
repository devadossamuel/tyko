{% extends "details_table.html" %}
{% from "_macros.html" import notes_table_head, notes_table_row, notes_new_button_row, note_editor_events %}
{% from "_details_macros.html" import add_field_row %} }}
{%- block entity_navbar -%}
{%- endblock -%}
{%- block detail_table %}
<div class="card my-1">
    <div class="card-body">
        <table class="table">
            <tbody>
                {%- for field in fields -%}
                    {{ add_field_row(field.name, field.key, (object.get(field.key) or ""), field.editable, api_path, loop.index) }}
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
<div class="card my-1">
    <div class="card-header">
        <h5 class="card-title">Items</h5>
    </div>
    <div class="card-body">
        <table class="table">
            <tbody>
                {% for item in object['items'] %}
                    <tr>
                        <td><a href="{{ url_for('page_projects')}}/{{ object['project_id'] }}/object/{{ object['object_id'] }}/item/{{ item['item_id'] }}">{{ item['name'] }}</a></td>
                    <td></td>
                    </tr>
                {%- endfor -%}
                    <tr>
                        <td></td>
                        <td>
                            <div class="btn-group float-right" role="group">
                                <button class="btn btn-primary" disabled>Add</button>
                            </div>
                        </td>
                    </tr>
            </tbody>
        </table>

    </div>
</div>
<div class="card">
    <h5 class="card-header">Notes</h5>
    <div class="card-body">
        <table class="table">
        {{ notes_table_head(object['notes']) }}
        <tbody>
            {%- for note in object['notes'] -%}
                {{ notes_table_row(note, "/api/project/" ~ object['project_id'] ~ "/object/" ~ object['object_id'] ~ "/notes/" ~ note['note_id'] ) }}
            {%- endfor -%}
            {{ notes_new_button_row(api_path) }}
        </tbody>
    </table>
    </div>
</div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    {{ note_editor_events("/api/project/" ~ object['project_id']~ "/object/" ~ object['object_id'], valid_note_types) }}
{% endblock %}